418
419  /*** END ***/

420  **********************************************************************;
421  * Project           : JACLS-ALL02
422  *
423  * Program name      : JACLS-ALL02_SDTM_SC.sas
424  *
425  * Author            : MATSUO YAMAMOTO
426  *
427  * Date created      : 20170330
428  *
429  * Purpose           : Create SC DataSet
430  *
431  * Revision History  :
432  *
433  * Date        Author           Ref    Revision (Date in YYYYMMDD format)
434  *
435  *
436  **********************************************************************;
437
438  /*** Initial setting ***/
439  %MACRO CURRENT_DIR;
440
441      %LOCAL _FULLPATH _PATH;
442      %LET   _FULLPATH = ;
443      %LET   _PATH     = ;
444
445      %IF %LENGTH(%SYSFUNC(GETOPTION(SYSIN))) = 0 %THEN
446          %LET _FULLPATH = %SYSGET(SAS_EXECFILEPATH);
447      %ELSE
448          %LET _FULLPATH = %SYSFUNC(GETOPTION(SYSIN));
449
450      %LET _PATH = %SUBSTR(   &_FULLPATH., 1, %LENGTH(&_FULLPATH.)
451                            - %LENGTH(%SCAN(&_FULLPATH.,-1,'\')) -1 );
452
453      &_PATH.
454
455  %MEND CURRENT_DIR;
456
457  %LET _PATH2 = %CURRENT_DIR;
458  %LET FILE = sc;
459
460  %INCLUDE "&_PATH2.\JACLS-ALL02_SDTM_LIBNAME.sas";
NOTE: WORK.MAIN (memtype=DATA)を削除します。
NOTE: WORK.SASMACR (memtype=CATALOG)を削除します。
NOTE: ファイルWORK.SASMACR (memtype=CATALOG)は使用中なので削除できません。
NOTE: WORK.WK01 (memtype=DATA)を削除します。
NOTE: WORK.WK02 (memtype=DATA)を削除します。
NOTE: WORK.WK10 (memtype=DATA)を削除します。

NOTE: PROCEDURE DATASETS処理(合計処理時間):
      処理時間           0.05 秒
      CPU時間            0.04 秒


NOTE: ライブラリ参照名LIBRAWを次のように割り当てました。
      エンジン: V9
      物理名: C:\Users\MatsuoYamamoto\Desktop\GitHub\knonc_mapping\JACLS-ALL02\input\rawdata
NOTE: ライブラリ参照名LIBEXTを次のように割り当てました。
      エンジン: V9
      物理名: C:\Users\MatsuoYamamoto\Desktop\GitHub\knonc_mapping\JACLS-ALL02\input\ext
NOTE: ライブラリ参照名LIBSDTMを次のように割り当てました。
      エンジン: V9
      物理名: C:\Users\MatsuoYamamoto\Desktop\GitHub\knonc_mapping\JACLS-ALL02\output\sdtm
521
522  /*** CSV read ***/
523  PROC IMPORT OUT= MAIN
524    DATAFILE="&RAW.\ALL-02_OSEFSdata v1.csv"
525    DBMS=CSV REPLACE;
526    GETNAMES=NO;
527    DATAROW=1;
528    GUESSINGROWS=5000;
529  RUN;

530   /**********************************************************************
531   *   プロダクト:   SAS
532   *   バージョン:   9.4
533   *   作成者:   外部ファイルインターフェイス
534   *   作成日:      30MAR17
535   *   説明:      生成された SAS データステップコード
536   *   テンプレート ソース:  (指定なし)
537   ***********************************************************************/
538      data WORK.MAIN    ;
539      %let _EFIERR_ = 0; /* エラー検出のマクロ変数を設定します */
540      infile
540! 'C:\Users\MatsuoYamamoto\Desktop\GitHub\knonc_mapping\JACLS-ALL02\input\rawdata\ALL-02_OSEFSdat
540! a v1.csv' delimiter = ',' MISSOVER DSD lrecl=32767 ;
541         informat VAR1 $3. ;
542         informat VAR2 $18. ;
543         informat VAR3 best32. ;
544         informat VAR4 best32. ;
545         informat VAR5 $2. ;
546         informat VAR6 $2. ;
547         informat VAR7 $2. ;
548         informat VAR8 $1. ;
549         informat VAR9 yymmdd10. ;
550         informat VAR10 best32. ;
551         informat VAR11 $10. ;
552         informat VAR12 best32. ;
553         informat VAR13 $2. ;
554         informat VAR14 yymmdd10. ;
555         informat VAR15 yymmdd10. ;
556         informat VAR16 yymmdd10. ;
557         informat VAR17 best32. ;
558         informat VAR18 $8. ;
559         informat VAR19 $83. ;
560         informat VAR20 $314. ;
561         informat VAR21 best32. ;
562         informat VAR22 $4. ;
563         informat VAR23 best32. ;
564         informat VAR24 $24. ;
565         informat VAR25 yymmdd10. ;
566         informat VAR26 yymmdd10. ;
567         informat VAR27 $358. ;
568         informat VAR28 $25. ;
569         informat VAR29 $8. ;
570         informat VAR30 yymmdd10. ;
571         informat VAR31 best32. ;
572         informat VAR32 yymmdd10. ;
573         informat VAR33 best32. ;
574         informat VAR34 yymmdd10. ;
575         informat VAR35 best32. ;
576         informat VAR36 yymmdd10. ;
577         informat VAR37 best32. ;
578         informat VAR38 yymmdd10. ;
579         informat VAR39 best32. ;
580         informat VAR40 yymmdd10. ;
581         informat VAR41 $81. ;
582         informat VAR42 best32. ;
583         informat VAR43 $8. ;
584         informat VAR44 yymmdd10. ;
585         informat VAR45 best32. ;
586         informat VAR46 $40. ;
587         informat VAR47 yymmdd10. ;
588         informat VAR48 best32. ;
589         informat VAR49 $8. ;
590         informat VAR50 yymmdd10. ;
591         informat VAR51 yymmdd10. ;
592         informat VAR52 best32. ;
593         informat VAR53 $4. ;
594         informat VAR54 yymmdd10. ;
595         informat VAR55 $17. ;
596         informat VAR56 best32. ;
597         informat VAR57 $8. ;
598         informat VAR58 $100. ;
599         informat VAR59 $536. ;
600         format VAR1 $3. ;
601         format VAR2 $18. ;
602         format VAR3 best12. ;
603         format VAR4 best12. ;
604         format VAR5 $2. ;
605         format VAR6 $2. ;
606         format VAR7 $2. ;
607         format VAR8 $1. ;
608         format VAR9 yymmdd10. ;
609         format VAR10 best12. ;
610         format VAR11 $10. ;
611         format VAR12 best12. ;
612         format VAR13 $2. ;
613         format VAR14 yymmdd10. ;
614         format VAR15 yymmdd10. ;
615         format VAR16 yymmdd10. ;
616         format VAR17 best12. ;
617         format VAR18 $8. ;
618         format VAR19 $83. ;
619         format VAR20 $314. ;
620         format VAR21 best12. ;
621         format VAR22 $4. ;
622         format VAR23 best12. ;
623         format VAR24 $24. ;
624         format VAR25 yymmdd10. ;
625         format VAR26 yymmdd10. ;
626         format VAR27 $358. ;
627         format VAR28 $25. ;
628         format VAR29 $8. ;
629         format VAR30 yymmdd10. ;
630         format VAR31 best12. ;
631         format VAR32 yymmdd10. ;
632         format VAR33 best12. ;
633         format VAR34 yymmdd10. ;
634         format VAR35 best12. ;
635         format VAR36 yymmdd10. ;
636         format VAR37 best12. ;
637         format VAR38 yymmdd10. ;
638         format VAR39 best12. ;
639         format VAR40 yymmdd10. ;
640         format VAR41 $81. ;
641         format VAR42 best12. ;
642         format VAR43 $8. ;
643         format VAR44 yymmdd10. ;
644         format VAR45 best12. ;
645         format VAR46 $40. ;
646         format VAR47 yymmdd10. ;
647         format VAR48 best12. ;
648         format VAR49 $8. ;
649         format VAR50 yymmdd10. ;
650         format VAR51 yymmdd10. ;
651         format VAR52 best12. ;
652         format VAR53 $4. ;
653         format VAR54 yymmdd10. ;
654         format VAR55 $17. ;
655         format VAR56 best12. ;
656         format VAR57 $8. ;
657         format VAR58 $100. ;
658         format VAR59 $536. ;
659      input
660                  VAR1 $
661                  VAR2 $
662                  VAR3
663                  VAR4
664                  VAR5 $
665                  VAR6 $
666                  VAR7 $
667                  VAR8 $
668                  VAR9
669                  VAR10
670                  VAR11 $
671                  VAR12
672                  VAR13 $
673                  VAR14
674                  VAR15
675                  VAR16
676                  VAR17
677                  VAR18 $
678                  VAR19 $
679                  VAR20 $
680                  VAR21
681                  VAR22 $
682                  VAR23
683                  VAR24 $
684                  VAR25
685                  VAR26
686                  VAR27 $
687                  VAR28 $
688                  VAR29 $
689                  VAR30
690                  VAR31
691                  VAR32
692                  VAR33
693                  VAR34
694                  VAR35
695                  VAR36
696                  VAR37
697                  VAR38
698                  VAR39
699                  VAR40
700                  VAR41 $
701                  VAR42
702                  VAR43 $
703                  VAR44
704                  VAR45
705                  VAR46 $
706                  VAR47
707                  VAR48
708                  VAR49 $
709                  VAR50
710                  VAR51
711                  VAR52
712                  VAR53 $
713                  VAR54
714                  VAR55 $
715                  VAR56
716                  VAR57 $
717                  VAR58 $
718                  VAR59 $
719      ;
720      if _ERROR_ then call symputx('_EFIERR_',1);  /* set ERROR detection macro variable */
721      run;

NOTE: 入力ファイル'C:\Users\MatsuoYamamoto\Desktop\GitHub\knonc_mapping\JACLS-ALL02\input\rawdata\AL
      L-02_OSEFSdata v1.csv' :

      ファイル名=C:\Users\MatsuoYamamoto\Desktop\GitHub\knonc_mapping\JACLS-ALL02\input\rawdata\ALL-
      02_OSEFSdata v1.csv,
      レコードフォーマット=V,論理レコード長=32767,
      ファイルサイズ (バイト)=239443,
      更新日時=2017年01月18日 14時09分06秒,
      作成日時=2017年03月30日 13時10分19秒

NOTE: 1252レコードを入力ファイル'C:\Users\MatsuoYamamoto\Desktop\GitHub\knonc_mapping\JACLS-ALL02\in
      put\rawdata\ALL-02_OSEFSdata v1.csv'から読み込みました。
      最小レコード長は119です。
      最大レコード長は789です。
NOTE: データセットWORK.MAINは1252オブザベーション、59変数です。
NOTE: DATAステートメント処理(合計処理時間):
      処理時間           0.47 秒
      CPU時間            0.43 秒


1252 行が WORK.MAIN に
C:\Users\MatsuoYamamoto\Desktop\GitHub\knonc_mapping\JACLS-ALL02\input\rawdata\ALL-02_OSEFSdata
v1.csv から作成されました。



NOTE: WORK.MAINデータセットが正常に作成されました。
NOTE: データセットWORK.MAINは1252オブザベーション、59変数です。
NOTE: PROCEDURE IMPORT処理(合計処理時間):
      処理時間           5.21 秒
      CPU時間            5.10 秒


722
723  /*** Extraction of mapping target ***/
724  DATA  WK01;
725    SET  MAIN;
726    IF  VAR1 = "0"; ***Eligibility only ;
727  RUN ;

NOTE: データセットWORK.MAINから1252オブザベーションを読み込みました。
NOTE: データセットWORK.WK01は1245オブザベーション、59変数です。
NOTE: DATAステートメント処理(合計処理時間):
      処理時間           0.04 秒
      CPU時間            0.03 秒


728
729  /*** Mapping ***/
730  DATA  WK02;
731    SET  WK01;
732    STUDYID = "JACLS-ALL02";
733    DOMAIN = "SC";
734    USUBJID = COMPRESS(STUDYID)||"-"||COMPRESS(PUT(VAR3,Z4.));
735    SCTESTCD = "DEFRISK";
736    SCTEST = "Definite Risk";
737    SCORRES = COMPRESS(VAR6);
738    SCSTRESC = COMPRESS(VAR6);
739  RUN ;

NOTE: データセットWORK.WK01から1245オブザベーションを読み込みました。
NOTE: データセットWORK.WK02は1245オブザベーション、66変数です。
NOTE: DATAステートメント処理(合計処理時間):
      処理時間           0.05 秒
      CPU時間            0.04 秒


740
741  PROC SORT DATA=WK02 ;BY USUBJID ; RUN ;

NOTE: データセットWORK.WK02から1245オブザベーションを読み込みました。
NOTE: データセットWORK.WK02は1245オブザベーション、66変数です。
NOTE: PROCEDURE SORT処理(合計処理時間):
      処理時間           0.04 秒
      CPU時間            0.01 秒


742
743  DATA  WK10;
744    SET  WK02;
745    RETAIN SCSEQ;
746    BY  USUBJID;
747    IF FIRST.USUBJID = 1 THEN SCSEQ = 0;
748    SCSEQ = SCSEQ + 1;
749  RUN ;

NOTE: データセットWORK.WK02から1245オブザベーションを読み込みました。
NOTE: データセットWORK.WK10は1245オブザベーション、67変数です。
NOTE: DATAステートメント処理(合計処理時間):
      処理時間           0.04 秒
      CPU時間            0.03 秒


750
751  PROC SQL ;
752     CREATE TABLE LIBSDTM.&FILE AS
753     SELECT
754      STUDYID  LENGTH=20    LABEL="Study Identifier",
755      DOMAIN  LENGTH=2    LABEL="Domain Abbreviation",
756      USUBJID  LENGTH=40    LABEL="Unique Subject Identifier",
757      SCSEQ      LABEL="Sequence Number",
758      SCTESTCD  LENGTH=8    LABEL="Subject Characteristic Short Name",
759      SCTEST  LENGTH=40    LABEL="Subject Characteristic",
760      SCORRES  LENGTH=200    LABEL="Result or Finding in Original Units",
761      SCSTRESC  LENGTH=200    LABEL="Character Result/Finding in Std Format"
762     FROM WK10;
NOTE: テーブルLIBSDTM.SC(行数1245、列数8)が作成されました。

763  QUIT ;
NOTE: PROCEDURE SQL処理(合計処理時間):
      処理時間           0.06 秒
      CPU時間            0.04 秒


764
765  FILENAME OUTF "&OUTPUT.\&FILE..csv" ;
766
767  PROC EXPORT DATA=LIBSDTM.&FILE. OUTFILE=OUTF
768    DBMS=CSV REPLACE;
769  RUN ;

770   /**********************************************************************
771   *   プロダクト:   SAS
772   *   バージョン:   9.4
773   *   作成者:   外部ファイルインターフェイス
774   *   作成日:      30MAR17
775   *   説明:      生成された SAS データステップコード
776   *   テンプレート ソース:  (指定なし)
777   ***********************************************************************/
778      data _null_;
779      %let _EFIERR_ = 0; /* エラー検出のマクロ変数を設定します */
780      %let _EFIREC_ = 0;     /* エクスポートレコードカウントのマクロ変数をクリアします */
781      file OUTF delimiter=',' DSD DROPOVER ;
782      if _n_ = 1 then        /* 列名またはラベルを書き出します */
783       do;
784         put
785            "STUDYID"
786         ','
787            "DOMAIN"
788         ','
789            "USUBJID"
790         ','
791            "SCSEQ"
792         ','
793            "SCTESTCD"
794         ','
795            "SCTEST"
796         ','
797            "SCORRES"
798         ','
799            "SCSTRESC"
800         ;
801       end;
802     set  LIBSDTM.SC   end=EFIEOD;
803         format STUDYID $20. ;
804         format DOMAIN $2. ;
805         format USUBJID $40. ;
806         format SCSEQ best12. ;
807         format SCTESTCD $8. ;
808         format SCTEST $40. ;
809         format SCORRES $200. ;
810         format SCSTRESC $200. ;
811       do;
812         EFIOUT + 1;
813         put STUDYID $ @;
814         put DOMAIN $ @;
815         put USUBJID $ @;
816         put SCSEQ @;
817         put SCTESTCD $ @;
818         put SCTEST $ @;
819         put SCORRES $ @;
820         put SCSTRESC $ ;
821         ;
822       end;
823      if _ERROR_ then call symputx('_EFIERR_',1);  /* set ERROR detection macro variable */
824      if EFIEOD then call symputx('_EFIREC_',EFIOUT);
825      run;

NOTE: 出力ファイルOUTF :
      ファイル名=C:\Users\MatsuoYamamoto\Desktop\GitHub\knonc_mapping\JACLS-ALL02\output\sdtm\sc.csv
      ,
      レコードフォーマット=V,論理レコード長=32767,
      ファイルサイズ (バイト)=0,
      更新日時=2017年03月30日 14時28分14秒,
      作成日時=2017年03月30日 14時28分14秒

NOTE: 1246レコードを出力ファイルOUTFに書き込みました。
      最小レコード長は57です。
      最大レコード長は61です。
NOTE: データセットLIBSDTM.SCから1245オブザベーションを読み込みました。
NOTE: DATAステートメント処理(合計処理時間):
      処理時間           0.14 秒
      CPU時間            0.06 秒


1245 レコードが OUTF に LIBSDTM.SC から作成されました。


NOTE: "OUTF" ファイルが正常に作成されました。
NOTE: PROCEDURE EXPORT処理(合計処理時間):
      処理時間           0.30 秒
      CPU時間            0.17 秒


826
827  %SDTM_FIN;

NOTE: DATAステートメント処理(合計処理時間):
      処理時間           0.00 秒
      CPU時間            0.00 秒


